<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¸ãƒ£ãƒ³ãƒ—æœ¬èªŒé–¢é€£Xãƒã‚¹ãƒˆæ•°</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@3.0.1/dist/chartjs-plugin-annotation.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <style>
        .nav-bar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px 30px;
            margin-bottom: 30px;
            border-radius: 12px;
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .nav-link {
            color: white;
            text-decoration: none;
            padding: 8px 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .nav-link.active {
            background: rgba(255, 255, 255, 0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“Š ã‚¸ãƒ£ãƒ³ãƒ—æœ¬èªŒé–¢é€£Xãƒã‚¹ãƒˆæ•°</h1>
        </div>
        
        <div class="nav-bar">
            <a href="/" class="nav-link active">ğŸ  ãƒ›ãƒ¼ãƒ </a>
            <a href="/data" class="nav-link">ğŸ“ˆ ãƒ‡ãƒ¼ã‚¿é–²è¦§</a>
        </div>

        <div class="datetime-setting">
            <h3>ğŸ“… åŸºæº–å·æ•°è¨­å®š</h3>
            <div class="datetime-input">
                <span class="datetime-label">åŸºæº–å·æ•°:</span>
                <select id="referenceIssueNumber" onchange="updateReferenceIssueNumber()">
                </select>
                <span id="selectedIssueDate" style="margin-left: 10px; color: #666; font-size: 0.9em;"></span>
            </div>
        </div>

        <div class="query-editor" id="trendEditor">
            <h2>ğŸ”¥ ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¯ãƒ¼ãƒ‰è¨­å®š</h2>
            <div class="trend-list" id="trendList">
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #f8f9fa;">
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #667eea;">ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¯ãƒ¼ãƒ‰</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #667eea;">ä½œå“å</th>
                            <th style="padding: 10px; text-align: left; border-bottom: 2px solid #667eea;">æœ€é«˜é †ä½</th>
                            <th style="padding: 10px; text-align: center; border-bottom: 2px solid #667eea; width: 100px;">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="trendTableBody">
                        <!-- ãƒˆãƒ¬ãƒ³ãƒ‰ãŒå‹•çš„ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                    </tbody>
                </table>
                <div style="margin-top: 15px; text-align: center;">
                    <button class="btn" onclick="addTrendRow()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                        â• ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¯ãƒ¼ãƒ‰ã‚’è¿½åŠ 
                    </button>
                </div>
            </div>
        </div>

        <div class="query-editor" id="queryEditor">
            <h2>ğŸ” æ¤œç´¢ã‚¯ã‚¨ãƒªè¨­å®š</h2>
            <div class="select-controls">
                <button class="btn btn-small" onclick="selectAllQueries()">âœ“ å…¨é¸æŠ</button>
                <button class="btn btn-small" onclick="deselectAllQueries()">âœ— å…¨è§£é™¤</button>
                <span class="select-count" id="selectCount">0/0 ä½œå“é¸æŠä¸­</span>
            </div>
            <div class="query-list" id="queryList"></div>
            <div class="editor-actions">
                <button class="btn btn-secondary" onclick="resetQueries()">ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã«æˆ»ã™</button>
            </div>
        </div>

        <div class="controls">
            <button class="btn" id="startBtn" onclick="startAnalysis()">
                ğŸš€ è§£æé–‹å§‹
            </button>
            <button class="btn btn-secondary" id="saveBtn" onclick="saveToCSV()" style="display: none;">
                ğŸ’¾ ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜
            </button>
        </div>

        <div class="progress-container" id="progressContainer">
            <h2>è§£æä¸­...</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            <div class="progress-text" id="progressText">æº–å‚™ä¸­...</div>
        </div>

        <div id="reportContainer" class="report-container">
            <div class="report-header">
                <h2 class="report-title">ä»Šé€±ã®ã‚¸ãƒ£ãƒ³ãƒ—æœ¬èªŒé–¢é€£Xãƒ‡ãƒ¼ã‚¿</h2>
                <p class="report-subtitle">ãƒ„ã‚¤ãƒ¼ãƒˆæ•°ï¼šYahooãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢ã‚’å…ƒã«é›†è¨ˆ</p>
                <p class="report-subtitle">ãƒˆãƒ¬ãƒ³ãƒ‰ï¼šTwitterdã‚’å…ƒã«é›†è¨ˆ</p>
            </div>
            <div id="rankingGrid" class="ranking-grid"></div>
        </div>

        <div id="summaryTable" style="display: none;" class="summary-table">
            <h2 style="margin-bottom: 20px; color: #667eea;">ğŸ“ˆ ã‚µãƒãƒªãƒ¼</h2>
            <table id="summaryTableContent"></table>
        </div>

        <div class="results-container" id="resultsContainer"></div>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
